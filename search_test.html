<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>ECharts</title>
    <script src="js/echarts.min.js"></script>
    <script src="js/jquery-3.6.0.min.js"></script>
</head>

<body>
    <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
    <div id="main" style="height:400px"></div>
    <script type="text/javascript">
        console.log(location.href);
        const idx = location.href.indexOf('name=');
        const val = location.href.slice(idx+5);
        console.log(val);
        const genenames = [],copynumbers =[];
        function getcopynumber() {
            $.ajax({
                type: "POST",
                url: "get_copynumber.php",
                async:false,
                data: {
                    gene_name: val
                },
                dataType:"json",
                success: function (result) {
                    if (result) {
                        console.log(result);
                        console.log(result.length);
                        for (var i = 0; i < result.length; i++) {
                            //console.log(i);
                            genenames.push(result[i].gene_name);
                            copynumbers.push(result[i].copy_number);
                        }
                    }

                },
                error: function (errorMsg) {
                    alert("sorry，request data failed!");
                }
            });
            console.log(genenames);
            console.log(copynumbers);
            return genenames, copynumbers;
        }
        getcopynumber();
        var myChart = echarts.init(document.getElementById('main'));
        var option = {
            tooltip:{
                trigger:'axis',
                axisPOinter:{
                    type:'shadow'
                }
            },
            xAxis: 
                {
                    type: 'category',
                    data: genenames,
                },
            yAxis: 
                {
                    type: 'value'
                },
            series: [
                {
                    type: "bar",
                    data: copynumbers,
                }
            ]
        };
        // 为echarts对象加载数据
        myChart.setOption(option);
            // }
    </script>
</body>

</html>